---
title: Feedback on your assignment
output: html_document
---

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

grade <- dplyr::filter(grades, student == teamid)
grade <- grade$grade[1]
first_name <- dplyr::filter(students, team == teamid)
first_name <- first_name$firstname[1]

teamnbr <- teachR::int(base::nrow(grades))
average <- teachR::dbl(base::mean(grades$grade))
sdev <- teachR::dbl(stats::sd(grades$grade))

perquestion <- feedback |>
  dplyr::filter(student == teamid) |>
  dplyr::select(question, points, earned) |>
  dplyr::group_by(question) |>
  dplyr::summarise(points = base::max(points), earned = base::sum(earned), .groups = "drop") |>
  dplyr::mutate(points = base::as.numeric(points), earned = base::as.numeric(earned)) |>
  dplyr::mutate(earned = dplyr::case_when(earned < points ~ earned, TRUE ~ points))
```



Good morning `r first_name`,  

I hope you are well. I know you were probably not expecting this feedback about your team assignment anymore, but I committed to to provide you with one, so here it is. The tool I am developing to generate these reports required several adjustments for open-ended team assignments, and this is why I have been late in delivering them. I sincerely apologize for the delay. 

The grade your team received for this assignment was `r grade` out of 20 points. More specifically, you earned `r perquestion$earned[1]` points on the first question (out of `r perquestion$points[1]`) and  `r perquestion$earned[2]` points on the second question (out of `r perquestion$points[2]`). To better understand where these grades come from, please find below my suggested answer as well as the criteria on which you earned points or failed to do so. I hope this feedback is helpful.  

Best regards,

Dr. Nicolas Mangin

<hr>

`r teamnbr` teams made the assignment for an average grade of `r average` and a standard deviation of `r sdev`.  

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, out.width="70%", fig.asp=.75, dev='png', fig.align="center"}
teachR::reports_draw_grade_density(grades, teamid)
```

**First question (reasons for and against abandoning budgets)**  

In the table below, you will find a detailed feedback about what was expected as an answer and the points you earned on each criterion. Note that since I did not require being exhaustive, the total number of points which could be earned (sum of "Points" in the table below) is greater than the number of points associated to the question (12). Of course, if you earned more than 12, your grade is limited to 12.  

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
teachR::reports_feedback_on_open(feedback, teamid, "Q000000183_US.Rmd")
```

<hr>

